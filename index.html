<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ†Ô∏è AI Gesture Password System</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Vue.js 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    
    <!-- TensorFlow.js Pose Detection -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js"></script>
    
    <style>
        [v-cloak] {
            display: none;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gesture-dot {
            animation: pulse 0.6s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .gesture-detected {
            animation: bounce 0.5s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        .status-unlocked {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
        
        .status-locked {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }
        
        .camera-container {
            position: relative;
            overflow: hidden;
            border-radius: 1rem;
        }
        
        canvas {
            transform: scaleX(-1);
            display: block;
        }
        
        .confidence-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.3);
            color: white;
        }
        
        .high-confidence {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .low-confidence {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .table-row-hover:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .loading-spinner {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div id="app" v-cloak class="min-h-screen py-8 px-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-bold text-white mb-2 drop-shadow-lg">üõ†Ô∏è AI Gesture Password</h1>
            <p class="text-white text-lg opacity-90">‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á AI ‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢</p>
        </div>
        
        <div class="max-w-6xl mx-auto">
            <!-- Main Container -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Column - Camera and Controls -->
                <div class="lg:col-span-2">
                    <!-- Status Bar -->
                    <div :class="['status-locked', 'rounded-t-2xl', 'p-6', 'text-white', 'transition-all', 'duration-300', { 'status-unlocked': isUnlocked }]">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</p>
                                <h2 class="text-4xl font-bold">{{ isUnlocked ? 'üîì UNLOCKED' : 'üîí LOCKED' }}</h2>
                            </div>
                            <div class="text-right">
                                <p class="text-sm opacity-90">‡πÄ‡∏ß‡∏•‡∏≤</p>
                                <p class="text-2xl font-mono">{{ currentTime }}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Camera Preview Section -->
                    <div class="glass-effect rounded-b-2xl p-6 mb-6">
                        <div class="mb-4">
                            <label class="block text-white font-semibold mb-2">üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á Webcam</label>
                            <div class="camera-container bg-black rounded-lg overflow-hidden border-4 border-white/20 h-96">
                                <video 
                                    ref="videoElement" 
                                    autoplay 
                                    playsinline 
                                    width="640" 
                                    height="480"
                                    class="w-full h-full object-cover"
                                />
                                <canvas 
                                    ref="canvasElement" 
                                    style="display: none;"
                                    width="640" 
                                    height="480"
                                />
                            </div>
                        </div>
                        
                        <!-- Model Status -->
                        <div class="bg-white/10 rounded-lg p-3 mb-4">
                            <div class="flex items-center justify-between">
                                <span class="text-white">
                                    <span v-if="!modelLoaded" class="loading-spinner">‚è≥</span>
                                    <span v-else>‚úÖ</span>
                                    ‡πÇ‡∏°‡πÄ‡∏î‡∏• AI
                                </span>
                                <span class="text-white font-semibold">{{ modelLoaded ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...' }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Current Gesture Detection -->
                    <div class="glass-effect rounded-2xl p-6">
                        <h3 class="text-white font-bold text-lg mb-4">üéØ ‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h3>
                        <div class="bg-white/10 rounded-lg p-6">
                            <div class="text-center">
                                <div class="text-7xl mb-3">{{ getCurrentGestureEmoji() }}</div>
                                <p class="text-white text-2xl font-bold">{{ currentGesture || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö' }}</p>
                                <div v-if="currentConfidence > 0" class="mt-3">
                                    <div class="confidence-badge" :class="{ 'high-confidence': currentConfidence > 0.85, 'low-confidence': currentConfidence <= 0.85 }">
                                        Confidence: {{ (currentConfidence * 100).toFixed(1) }}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Column - Settings and Status -->
                <div class="space-y-6">
                    <!-- Gesture Sequence Display -->
                    <div class="glass-effect rounded-2xl p-6">
                        <h3 class="text-white font-bold text-lg mb-4">üìç ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á</h3>
                        <div class="bg-white/10 rounded-lg p-6">
                            <div class="flex gap-3 justify-center mb-4 flex-wrap">
                                <span v-for="(gesture, index) in detectedSequence" :key="index" class="gesture-detected">
                                    <span class="text-3xl">{{ getGestureEmoji(gesture) }}</span>
                                </span>
                                <span v-for="i in (requiredLength - detectedSequence.length)" :key="'empty-' + i" class="gesture-dot">
                                    <span class="text-2xl opacity-40">‚≠ï</span>
                                </span>
                            </div>
                            <p class="text-white text-center">
                                <span class="font-bold">{{ detectedSequence.length }}</span> / 
                                <span class="font-bold">{{ requiredLength }}</span>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Password Setup -->
                    <div class="glass-effect rounded-2xl p-6">
                        <h3 class="text-white font-bold text-lg mb-4">üîê ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h3>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-white text-sm font-semibold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á)</label>
                                <div class="flex gap-2 flex-wrap bg-white/10 p-3 rounded-lg">
                                    <span v-for="(gesture, index) in passwordSequence" :key="index" class="text-xl">
                                        {{ getGestureEmoji(gesture) }}
                                    </span>
                                    <span v-if="passwordSequence.length === 0" class="text-white/50 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™</span>
                                </div>
                            </div>
                            <button 
                                @click="setNewPassword"
                                :disabled="detectedSequence.length < requiredLength"
                                class="w-full py-2 px-4 bg-white/20 hover:bg-white/30 disabled:bg-white/10 disabled:opacity-50 text-white font-semibold rounded-lg transition-all duration-200"
                            >
                                üìù ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                            </button>
                            <button 
                                @click="resetPassword"
                                :disabled="passwordSequence.length === 0"
                                class="w-full py-2 px-4 bg-red-500/20 hover:bg-red-500/30 disabled:bg-white/10 disabled:opacity-50 text-white font-semibold rounded-lg transition-all duration-200"
                            >
                                üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™
                            </button>
                        </div>
                    </div>
                    
                    <!-- Quick Controls -->
                    <div class="glass-effect rounded-2xl p-6">
                        <h3 class="text-white font-bold text-lg mb-4">‚öôÔ∏è ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</h3>
                        <div class="space-y-2">
                            <button 
                                @click="resetSequence"
                                class="w-full py-2 px-4 bg-yellow-500/20 hover:bg-yellow-500/30 text-white font-semibold rounded-lg transition-all duration-200"
                            >
                                üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡∏≥‡∏î‡∏±‡∏ö
                            </button>
                            <button 
                                @click="toggleDebugMode"
                                class="w-full py-2 px-4 bg-blue-500/20 hover:bg-blue-500/30 text-white font-semibold rounded-lg transition-all duration-200"
                            >
                                {{ debugMode ? 'üîç ‡∏õ‡∏¥‡∏î' : 'üîç ‡πÄ‡∏õ‡∏¥‡∏î' }} Debug Mode
                            </button>
                            <button 
                                @click="clearHistory"
                                class="w-full py-2 px-4 bg-red-500/20 hover:bg-red-500/30 text-white font-semibold rounded-lg transition-all duration-200"
                            >
                                üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Debug Info -->
            <div v-if="debugMode" class="glass-effect rounded-2xl p-6 mt-6">
                <h3 class="text-white font-bold text-lg mb-4">üêõ Debug Information</h3>
                <div class="grid grid-cols-2 gap-4 text-white text-sm">
                    <div class="bg-white/10 p-3 rounded">
                        <p class="font-semibold">Password Set:</p>
                        <p>{{ passwordSequence.length > 0 ? 'Yes' : 'No' }}</p>
                    </div>
                    <div class="bg-white/10 p-3 rounded">
                        <p class="font-semibold">Sequence Progress:</p>
                        <p>{{ detectedSequence.length }} / {{ requiredLength }}</p>
                    </div>
                    <div class="bg-white/10 p-3 rounded">
                        <p class="font-semibold">Current Gesture:</p>
                        <p>{{ currentGesture || 'None' }}</p>
                    </div>
                    <div class="bg-white/10 p-3 rounded">
                        <p class="font-semibold">Confidence:</p>
                        <p>{{ (currentConfidence * 100).toFixed(1) }}%</p>
                    </div>
                </div>
            </div>
            
            <!-- History Section -->
            <div class="glass-effect rounded-2xl p-6 mt-6">
                <h3 class="text-white font-bold text-lg mb-4">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-white text-sm">
                        <thead>
                            <tr class="border-b border-white/20">
                                <th class="text-left py-2 px-2">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="text-left py-2 px-2">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="text-left py-2 px-2">‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th>
                                <th class="text-left py-2 px-2">üéØ ‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(log, index) in accessHistory.slice(0, 10)" :key="index" class="table-row-hover border-b border-white/10">
                                <td class="py-3 px-2 font-mono text-xs">{{ formatTime(log.timestamp) }}</td>
                                <td class="py-3 px-2">
                                    <span v-if="log.status === 'success'" class="bg-green-500/30 px-2 py-1 rounded text-green-200">
                                        ‚úÖ Success
                                    </span>
                                    <span v-else class="bg-red-500/30 px-2 py-1 rounded text-red-200">
                                        ‚ùå Failed
                                    </span>
                                </td>
                                <td class="py-3 px-2">{{ log.attempCount || 1 }}</td>
                                <td class="py-3 px-2 font-mono">{{ log.sequence.map(g => getGestureEmoji(g)).join('') }}</td>
                            </tr>
                            <tr v-if="accessHistory.length === 0">
                                <td colspan="4" class="py-8 text-center text-white/50">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
